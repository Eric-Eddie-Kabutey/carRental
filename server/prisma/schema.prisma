// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

// --- CMS / Dynamic Content ---

model Brand {
    id        String   @id @default(cuid())
    name      String
    logoUrl   String?
    isActive  Boolean  @default(true)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Testimonial {
    id        String   @id @default(cuid())
    name      String
    role      String?
    content   String
    rating    Int      @default(5)
    avatarUrl String?
    isActive  Boolean  @default(true)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model FAQ {
    id        String   @id @default(cuid())
    question  String
    answer    String
    category  String   @default("General") // Home, Rental, Payments, etc.
    order     Int      @default(0)
    isActive  Boolean  @default(true)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model SocialLink {
    id        String   @id @default(cuid())
    platform  String // Instagram, Facebook, etc.
    url       String
    icon      String? // lucide-react icon name
    isActive  Boolean  @default(true)
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model PageContent {
    id         String   @id @default(cuid())
    pageKey    String // e.g., "home", "about", "services"
    sectionKey String // e.g., "hero", "mission", "contact-info"
    content    String // stored as JSON String
    createdAt  DateTime @default(now())
    updatedAt  DateTime @updatedAt

    @@unique([pageKey, sectionKey])
}

// --- Vehicle & Rental Core ---

model Vehicle {
    id    String  @id @default(cuid())
    brand String
    model String
    year  Int
    trim  String?

    // Specs
    bodyType     String // SUV, Sedan, Coupe...
    fuelType     String // Petrol, Diesel, Hybrid, Electric
    transmission String // Automatic, Manual
    seats        Int
    doors        Int
    engine       String? // e.g. "V8 4.0L"
    color        String?
    kmPerDay     Int?
    minAge       Int?
    depositText  String? // e.g. "5000 AED"
    description  String?

    isActive Boolean @default(true)

    // Pricing (Estimated)
    pricePerDay   Float?
    pricePerWeek  Float?
    pricePerMonth Float?
    currency      String @default("AED")

    images   VehicleImage[]
    bookings BookingRequest[]
    blocks   AvailabilityBlock[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model VehicleImage {
    id        String  @id @default(cuid())
    vehicleId String
    url       String
    isPrimary Boolean @default(false)

    vehicle Vehicle @relation(fields: [vehicleId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now())
}

model AvailabilityBlock {
    id        String   @id @default(cuid())
    vehicleId String
    startAt   DateTime
    endAt     DateTime
    reason    String // Maintenance, Repair, Other

    vehicle Vehicle @relation(fields: [vehicleId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now())
}

model BookingRequest {
    id         String @id @default(cuid())
    requestRef String @unique // e.g. CR-202X-XXXX

    vehicleId String
    vehicle   Vehicle @relation(fields: [vehicleId], references: [id])

    // Customer Info (No Account)
    customerName  String?
    customerPhone String?

    // Details
    startAt         DateTime
    endAt           DateTime
    pickupLocation  String?
    dropoffLocation String?

    addOnsSnapshot String? // stored as JSON String
    estimatedTotal Float?

    status String @default("requested") // requested, confirmed, cancelled, expired

    // For admin notes or internal tracking
    notes String?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
}

model Location {
    id       String  @id @default(cuid())
    name     String
    address  String
    isActive Boolean @default(true)
}
